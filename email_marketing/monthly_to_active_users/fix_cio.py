from customerio import CustomerIO
import requests
import json



#cio.identify(id='925066', newsletter_items_delivered='79726,87666,87686,87693,650,701,716,718,100331,100340,100362,90607,99176,99177,99178,755,787,807,810')

#for cio_id,new_attribute in fixes:
#  print(cio_id + ': ' + new_attribute)

def rollback_sonlet():
    cio = CustomerIO('6d30b69c3d9afe45835b', 'd3951fc08db29107a260')
    
    fixes = {
        '970414':'100331,100340,100362,90607,99176,99177,99178,755,787,807,810',
        '59222':'79726,87666,87686,87693,650,701,716,718,100331,100340,100362,90607,99176,99177,99178,755,787,807,810,,595,612,684,742',
        '136314':'79726,87666,87686,87693,650,701,716,718,100331,100340,100362,90607,99176,99177,99178,755,787,807,810,,595,612,684,742',
        '36477':'79726,87666,87686,87693,650,701,716,718,69622,69978,70114,73090,595,612,682,684,100331,100340,100362,90607,99176,99177,99178,755,787,807,810,,533,543,585,742',
        '103532':'79726,87666,87686,87693,650,701,716,718,100331,100340,100362,90607,99176,99177,99178,755,787,807,810,,595,612,684,742',
        '2549':'79726,87666,87686,87693,650,701,716,718,100331,100340,100362,90607,99176,99177,99178,755,787,807,810,,595,612,684,742',
        '383882':'79726,87666,87686,87693,650,701,716,718,100331,100340,100362,90607,99176,99177,99178,755,787,807,810,,595,612,684,742',
        '125421':'79726,87666,87686,87693,650,701,716,718,69622,69978,70114,73090,595,612,682,684,100331,100340,100362,90607,99176,99177,99178,755,787,807,810,,533,543,585,742',
        '470544':'79726,87666,87686,87693,650,701,716,718,100331,100340,100362,90607,99176,99177,99178,755,787,807,810',
        '28463':'79726,87666,87686,87693,650,701,716,718,100331,100340,100362,90607,99176,99177,99178,755,787,807,810,,595,612,684,742',
        '93281':'100331,100340,100362,90607,99176,99177,99178,755,787,807,810',
        '1':'79726,87666,87686,87693,650,701,716,718,69622,69978,70114,73090,595,612,682,684,100331,100340,100362,90607,99176,99177,99178,755,787,807,810,,533,543,585,742',
        '5':'79726,87666,87686,87693,650,701,716,718,69622,69978,70114,73090,595,612,682,684,100331,100340,100362,90607,99176,99177,99178,755,787,807,810,,533,543,585,742'
    }
    
    for cio_id,new_attribute in fixes.items():
      cio.identify(id=cio_id, newsletter_items_delivered=new_attribute)
      print('cio_id: ' + cio_id)
      print('new_attribute: ' + new_attribute)
    
def rollback_piu():
    cio = CustomerIO('0dfefb1081f03692b8ce', '9d368b1ddbe561236ab0')
    
    fixes = {
        '1':'4a37a,4be72,0ea0a,ef3b6,4ed57,8137e,3d6c7,e9298,',
        '95':'4a37a,4be72,0ea0a,ef3b6',
        '3':'4a37a,4be72,0ea0a,ef3b6,,4ed57,8137e,3d6c7,e9298,ffaa5,fe8d5,f3d66a3bf2,e2149,afdc4,e75c1,a3bf2,51d92,b3061,290a3,',
        '7':'4a37a,4be72,0ea0a,ef3b6,4ed57,8137e,3d6c7,e9298,',
        '9':'4a37a,4be72,0ea0a,ef3b6,4ed57,8137e,3d6c7,e9298,',
        '62':'4a37a,4be72,0ea0a,ef3b6,4ed57,8137e,3d6c7,e9298',
        '137':'4a37a,4be72,0ea0a,ef3b6,4ed57,8137e,3d6c7,e9298,',
        '295':'4a37a,4be72,0ea0a,ef3b6,',
        '2':'4a37a,4be72,0ea0a,ef3b6,',
        '10':'4a37a,4be72,0ea0a,ef3b6,4ed57,8137e,3d6c7,e9298,',
        '17':'4a37a,4be72,0ea0a,ef3b6,',
        '5826':'4a37a,4be72,0ea0a,ef3b6,4ed57,8137e,3d6c7,e9298,',
        '6349':'4a37a,4be72,0ea0a,ef3b6,'
    }
    
    for cio_id,new_attribute in fixes.items():
      cio.identify(id=cio_id, newsletter_items_delivered=new_attribute)
      print('cio_id: ' + cio_id)
      print('new_attribute: ' + new_attribute)
    

def get_cio_segment_members(site_id, api_key, segment_id):
    auth = (site_id, api_key)
    url = 'https://api.customer.io/v1/api/segments/' + str(segment_id) + '/customer_count'
    headers = {'Content-Type': 'application/json'}
    # Send POST request to trigger API triggered campaign
    r = requests.get(url=url, auth=auth, headers=headers)
    
    return r.text
    
#print(get_cio_segment_members('0dfefb1081f03692b8ce', '9d368b1ddbe561236ab0', 43))
rollback_piu()
    